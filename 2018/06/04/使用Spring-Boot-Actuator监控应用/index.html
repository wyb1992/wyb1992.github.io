<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Actuator是Spring Boot的一个附加功能，可以帮助你在应用程序生产环境时监视和管理应用程序。可以使用HTTP的各种请求来监管、审计和收集应用的运行情况。 微服务的特点决定了功能模块的部署是分布式的，大部分功能模块都是运行在不同的机器上，彼此通过服务调用进行交互，前后台的业务流会经过很多个微服务的处理和传递，出现了异常如何快速定位是哪个环节出现了问题。 在这种框架下，微服务的监控显得尤">
<meta name="keywords" content="spring boot,后端">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Spring Boot Actuator监控应用">
<meta property="og:url" content="https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/index.html">
<meta property="og:site_name" content="wyb&#39;s blogs">
<meta property="og:description" content="Actuator是Spring Boot的一个附加功能，可以帮助你在应用程序生产环境时监视和管理应用程序。可以使用HTTP的各种请求来监管、审计和收集应用的运行情况。 微服务的特点决定了功能模块的部署是分布式的，大部分功能模块都是运行在不同的机器上，彼此通过服务调用进行交互，前后台的业务流会经过很多个微服务的处理和传递，出现了异常如何快速定位是哪个环节出现了问题。 在这种框架下，微服务的监控显得尤">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://wyb1992.github.io/images/spring-boot-actuator/spring-boot-actuator-1.jpg">
<meta property="og:updated_time" content="2018-06-07T05:11:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用Spring Boot Actuator监控应用">
<meta name="twitter:description" content="Actuator是Spring Boot的一个附加功能，可以帮助你在应用程序生产环境时监视和管理应用程序。可以使用HTTP的各种请求来监管、审计和收集应用的运行情况。 微服务的特点决定了功能模块的部署是分布式的，大部分功能模块都是运行在不同的机器上，彼此通过服务调用进行交互，前后台的业务流会经过很多个微服务的处理和传递，出现了异常如何快速定位是哪个环节出现了问题。 在这种框架下，微服务的监控显得尤">
<meta name="twitter:image" content="https://wyb1992.github.io/images/spring-boot-actuator/spring-boot-actuator-1.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>使用Spring Boot Actuator监控应用</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="https://github.com/wyb1992">项目</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/06/05/使用Spring-Boot-Admin对应用进行监控/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/06/02/何如用Chorme把PWA网站添加到桌面/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&text=使用Spring Boot Actuator监控应用"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&is_video=false&description=使用Spring Boot Actuator监控应用"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=使用Spring Boot Actuator监控应用&body=Check out this article: https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&name=使用Spring Boot Actuator监控应用&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#初识Actuator"><span class="toc-number">1.</span> <span class="toc-text">初识Actuator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原生端点"><span class="toc-number">2.</span> <span class="toc-text">原生端点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用配置类"><span class="toc-number">3.</span> <span class="toc-text">应用配置类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#autoconfig"><span class="toc-number">3.1.</span> <span class="toc-text">/autoconfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beans"><span class="toc-number">3.2.</span> <span class="toc-text">/beans</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configprops"><span class="toc-number">3.3.</span> <span class="toc-text">/configprops</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#env"><span class="toc-number">3.4.</span> <span class="toc-text">/env</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mappings"><span class="toc-number">3.5.</span> <span class="toc-text">/mappings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#info"><span class="toc-number">3.6.</span> <span class="toc-text">/info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#度量类指标"><span class="toc-number">4.</span> <span class="toc-text">度量类指标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-number">4.1.</span> <span class="toc-text">/metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump"><span class="toc-number">4.2.</span> <span class="toc-text">/dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace"><span class="toc-number">4.3.</span> <span class="toc-text">/trace</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作控制类"><span class="toc-number">5.</span> <span class="toc-text">操作控制类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shutdown"><span class="toc-number">5.1.</span> <span class="toc-text">/shutdown</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        使用Spring Boot Actuator监控应用
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">wyb's blogs</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-06-04T11:25:19.000Z" itemprop="datePublished">2018-06-04</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/spring-boot/">spring boot</a>, <a class="tag-link" href="/tags/后端/">后端</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Actuator是Spring Boot的一个附加功能，可以帮助你在应用程序生产环境时监视和管理应用程序。可以使用HTTP的各种请求来监管、审计和收集应用的运行情况。</p>
<p>微服务的特点决定了功能模块的部署是分布式的，大部分功能模块都是运行在不同的机器上，彼此通过服务调用进行交互，前后台的业务流会经过很多个微服务的处理和传递，出现了异常如何快速定位是哪个环节出现了问题。</p>
<p>在这种框架下，微服务的监控显得尤为重要。本文主要结合Spring Boot Actuator，跟大家一起分享微服务Spring Boot Actuator的常见用法，方便我们在日常中对我们的微服务进行监控治理。</p>
<h2 id="初识Actuator"><a href="#初识Actuator" class="headerlink" title="初识Actuator"></a>初识Actuator</h2><p>下面，我们可以通过对快速入门中实现的Spring Boot应用增加<code>spring-boot-starter-actuator</code>模块功能，来对它有一个直观的认识。</p>
<p>在现有的Spring Boot应用中引入该模块非常简单，只需要在<code>pom.xml</code>的<code>dependencies</code>节点中，新增<code>spring-boot-starter-actuator</code>的依赖即可，具体如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>通过增加该依赖之后，重新启动应用。此时，我们可以在控制台中看到如下图所示的输出：</p>
<p><img src="/images/spring-boot-actuator/spring-boot-actuator-1.jpg" alt="spring-boot-actuator-1"></p>
<p>上图显示了一批端点定义，这些端点并非我们自己在程序中创建，而是由<code>spring-boot-starter-actuator</code>模块根据应用依赖和配置自动创建出来的监控和管理端点。通过这些端点，我们可以实时的获取应用的各项监控指标，比如：访问<code>/health</code>端点，我们可以获得如下返回的应用健康信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;status&quot;: &quot;UP&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="原生端点"><a href="#原生端点" class="headerlink" title="原生端点"></a>原生端点</h2><p>通过在快速入门示例中添加<code>spring-boot-starter-actuator</code>模块，我们已经对它有了一个初步的认识。接下来，我们详细介绍一下<code>spring-boot-starter-actuator</code>模块中已经实现的一些原生端点。如果根据端点的作用来说，我们可以原生端点分为三大类：</p>
<ul>
<li>应用配置类：获取应用程序中加载的应用配置、环境变量、自动化配置报告等与Spring Boot应用密切相关的配置类信息。</li>
<li>度量指标类：获取应用程序运行过程中用于监控的度量指标，比如：内存信息、线程池信息、HTTP请求统计等。</li>
<li>操作控制类：提供了对应用的关闭等操作类功能。</li>
</ul>
<table>
<thead>
<tr>
<th>ID</th>
<th>HTTP 方法</th>
<th>描述</th>
<th>是否需要鉴权</th>
</tr>
</thead>
<tbody>
<tr>
<td>actuator</td>
<td>GET</td>
<td>为其他端点提供“发现页面”。要求Spring HATEOAS在classpath路径上。</td>
<td>需要</td>
</tr>
<tr>
<td>auditevents</td>
<td>GET</td>
<td>陈列当前应用程序的审计事件信息。</td>
<td>需要</td>
</tr>
<tr>
<td>autoconfig</td>
<td>GET</td>
<td>展示自动配置信息并且显示所有自动配置候选人以及他们“被不被”应用的原因。</td>
<td>需要</td>
</tr>
<tr>
<td>beans</td>
<td>GET</td>
<td>显示应用程序中所有Spring bean的完整列表。</td>
<td>需要</td>
</tr>
<tr>
<td>configprops</td>
<td>GET</td>
<td>显示所有配置信息。</td>
<td>需要</td>
</tr>
<tr>
<td>dump</td>
<td>GET</td>
<td>dump所有线程。</td>
<td>需要</td>
</tr>
<tr>
<td>env</td>
<td>GET</td>
<td>陈列所有的环境变量。</td>
<td>需要</td>
</tr>
<tr>
<td>flyway</td>
<td>GET</td>
<td>Shows any Flyway database migrations that have been applied.</td>
<td>需要</td>
</tr>
<tr>
<td>health</td>
<td>GET</td>
<td>显示应用程序运行状况信息</td>
<td>不需要</td>
</tr>
<tr>
<td>info</td>
<td>GET</td>
<td>显示应用信息。</td>
<td>不需要</td>
</tr>
<tr>
<td>loggers</td>
<td>GET</td>
<td>显示和修改应用程序中的loggers配置。</td>
<td>需要</td>
</tr>
<tr>
<td>liquibase</td>
<td>GET</td>
<td>显示已经应用的任何Liquibase数据库迁移。</td>
<td>需要</td>
</tr>
<tr>
<td>metrics</td>
<td>GET</td>
<td>显示当前应用程序的“指标”信息。</td>
<td>需要</td>
</tr>
<tr>
<td>mappings</td>
<td>GET</td>
<td>显示所有<code>@RequestMapping</code>的url整理列表。</td>
<td>需要</td>
</tr>
<tr>
<td>shutdown</td>
<td>POST</td>
<td>关闭应用，要求endpoints.shutdown.enabled设置为true（默认情况下不启用）。</td>
<td>需要</td>
</tr>
<tr>
<td>trace</td>
<td>GET</td>
<td>显示跟踪信息（默认最后100个HTTP请求）。</td>
<td>需要</td>
</tr>
</tbody>
</table>
<p>下面我们来详细了解一下这三类端点都分别可以为我们提供怎么样的有用信息和强大功能，以及我们如何去扩展和配置它们。</p>
<h2 id="应用配置类"><a href="#应用配置类" class="headerlink" title="应用配置类"></a>应用配置类</h2><p>由于Spring Boot为了改善传统Spring应用繁杂的配置内容，采用了包扫描和自动化配置的机制来加载原本集中于xml文件中的各项内容。虽然这样的做法，让我们的代码变得非常简洁，但是整个应用的实例创建和依赖关系等信息都被离散到了各个配置类的注解上，这使得我们分析整个应用中资源和实例的各种关系变得非常的困难。而这类端点就可以帮助我们轻松的获取一系列关于Spring 应用配置内容的详细报告，比如：自动化配置的报告、Bean创建的报告、环境属性的报告等。</p>
<h3 id="autoconfig"><a href="#autoconfig" class="headerlink" title="/autoconfig"></a>/autoconfig</h3><p>该端点用来获取应用的自动化配置报告，其中包括所有自动化配置的候选项。同时还列出了每个候选项自动化配置的各个先决条件是否满足。所以，该端点可以帮助我们方便的找到一些自动化配置为什么没有生效的具体原因。该报告内容将自动化配置内容分为两部分：</p>
<pre><code>*   `positiveMatches`中返回的是条件匹配成功的自动化配置
*   `negativeMatches`中返回的是条件匹配不成功的自动化配置
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;positiveMatches&quot;: &#123;</span><br><span class="line">		&quot;SpringBootAdminClientAutoConfiguration&quot;: [&#123;</span><br><span class="line">				&quot;condition&quot;: &quot;OnWebApplicationCondition&quot;,</span><br><span class="line">				&quot;message&quot;: &quot;@ConditionalOnWebApplication (required) found StandardServletEnvironment&quot;</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				&quot;condition&quot;: &quot;SpringBootAdminClientEnabledCondition&quot;,</span><br><span class="line">				&quot;message&quot;: &quot;matched&quot;</span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	  ...</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;negativeMatches&quot;: &#123;</span><br><span class="line">		&quot;CacheStatisticsAutoConfiguration&quot;: &#123;</span><br><span class="line">			&quot;notMatched&quot;: [&#123;</span><br><span class="line">				&quot;condition&quot;: &quot;OnBeanCondition&quot;,</span><br><span class="line">				&quot;message&quot;: &quot;@ConditionalOnBean (types: org.springframework.cache.CacheManager; SearchStrategy: all) did not find any beans&quot;</span><br><span class="line">			&#125;],</span><br><span class="line">			&quot;matched&quot;: [</span><br><span class="line"></span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从如上示例中我们可以看到，每个自动化配置候选项中都有一系列的条件，比如上面没有成功匹配的<code>HealthIndicatorAutoConfiguration.DataSourcesHealthIndicatorConfiguration</code>配置，它的先决条件就是需要在工程中包含<code>org.springframework.jdbc.core.JdbcTemplate</code>类，由于我们没有引入相关的依赖，它就不会执行自动化配置内容。所以，当我们发现有一些期望的配置没有生效时，就可以通过该端点来查看没有生效的具体原因。</p>
<h3 id="beans"><a href="#beans" class="headerlink" title="/beans"></a>/beans</h3><p>该端点用来获取应用上下文中创建的所有Bean。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">	&quot;context&quot;: &quot;wk-xcx:dev:17140&quot;,</span><br><span class="line">	&quot;parent&quot;: null,</span><br><span class="line">	&quot;beans&quot;: [&#123;</span><br><span class="line">		&quot;bean&quot;: &quot;wkApiApplication&quot;,</span><br><span class="line">		&quot;aliases&quot;: [],</span><br><span class="line">		&quot;scope&quot;: &quot;singleton&quot;,</span><br><span class="line">		&quot;type&quot;: &quot;com.peilian.wk.WkApiApplication$$EnhancerBySpringCGLIB$$e2f29167&quot;,</span><br><span class="line">		&quot;resource&quot;: &quot;null&quot;,</span><br><span class="line">		&quot;dependencies&quot;: []</span><br><span class="line">	&#125;]</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<p>如上示例中，我们可以看到在每个bean中都包含了下面这几个信息：</p>
<ul>
<li>bean：Bean的名称</li>
<li>scope：Bean的作用域</li>
<li>type：Bean的Java类型</li>
<li>reource：class文件的具体路径</li>
<li>dependencies：依赖的Bean名称</li>
</ul>
<h3 id="configprops"><a href="#configprops" class="headerlink" title="/configprops"></a>/configprops</h3><p>该端点用来获取应用中配置的属性信息报告。从下面该端点返回示例的片段中，我们看到返回了关于该短信的配置信息，<code>prefix</code>属性代表了属性的配置前缀，<code>properties</code>代表了各个属性的名称和值。所以，我们可以通过该报告来看到各个属性的配置路径，比如我们要关闭该端点，就可以通过使用<code>endpoints.configprops.enabled=false</code>来完成设置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;endpoints-org.springframework.boot.actuate.endpoint.EndpointProperties&quot;: &#123;</span><br><span class="line">		&quot;prefix&quot;: &quot;endpoints&quot;,</span><br><span class="line">		&quot;properties&quot;: &#123;</span><br><span class="line">			&quot;enabled&quot;: true,</span><br><span class="line">			&quot;sensitive&quot;: null</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="env"><a href="#env" class="headerlink" title="/env"></a>/env</h3><p>该端点与<code>/configprops</code>不同，它用来获取应用所有可用的环境属性报告。包括：环境变量、JVM属性、应用的配置配置、命令行中的参数。从下面该端点返回的示例片段中，我们可以看到它不仅返回了应用的配置属性，还返回了系统属性、环境变量等丰富的配置信息，其中也包括了应用还没有没有使用的配置。所以它可以帮助我们方便地看到当前应用可以加载的配置信息，并配合<code>@ConfigurationProperties</code>注解将它们引入到我们的应用程序中来进行使用。另外，为了配置属性的安全，对于一些类似密码等敏感信息，该端点都会进行隐私保护，但是我们需要让属性名中包含：password、secret、key这些关键词，这样该端点在返回它们的时候会使用<code>*</code>来替代实际的属性值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;profiles&quot;: [</span><br><span class="line">    &quot;dev&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;server.ports&quot;: &#123;</span><br><span class="line">    &quot;local.server.port&quot;: 17140</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;commandLineArgs&quot;: &#123;</span><br><span class="line">    &quot;server.port&quot;: &quot;17140&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;servletContextInitParams&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;systemProperties&quot;: &#123;</span><br><span class="line">    &quot;java.runtime.name&quot;: &quot;Java(TM) SE Runtime Environment&quot;,</span><br><span class="line">    &quot;java.protocol.handler.pkgs&quot;: &quot;org.springframework.boot.loader&quot;,</span><br><span class="line">    &quot;sun.boot.library.path&quot;: &quot;/opt/jdk1.8.0_162/jre/lib/amd64&quot;,</span><br><span class="line">    &quot;java.vm.version&quot;: &quot;25.162-b12&quot;,</span><br><span class="line">    &quot;java.vm.vendor&quot;: &quot;Oracle Corporation&quot;,</span><br><span class="line">    &quot;java.vendor.url&quot;: &quot;http://java.oracle.com/&quot;,</span><br><span class="line">    &quot;path.separator&quot;: &quot;:&quot;,</span><br><span class="line">   ...</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;applicationConfig: [classpath:/application-dev.yml]&quot;: &#123;</span><br><span class="line">    &quot;server.port&quot;: 17140</span><br><span class="line">	...</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="mappings"><a href="#mappings" class="headerlink" title="/mappings"></a>/mappings</h3><p>该端点用来返回所有Spring MVC的控制器映射关系报告。从下面的示例片段中，我们可以看该报告的信息与我们在启用Spring MVC的Web应用时输出的日志信息类似，其中<code>bean</code>属性标识了该映射关系的请求处理器，<code>method</code>属性标识了该映射关系的具体处理类和处理函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;/webjars/**&quot;: &#123;</span><br><span class="line">		&quot;bean&quot;: &quot;resourceHandlerMapping&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;/**&quot;: &#123;</span><br><span class="line">		&quot;bean&quot;: &quot;resourceHandlerMapping&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;/**/favicon.ico&quot;: &#123;</span><br><span class="line">		&quot;bean&quot;: &quot;faviconHandlerMapping&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="info"><a href="#info" class="headerlink" title="/info"></a>/info</h3><p>该端点用来返回一些应用自定义的信息。默认情况下，该端点只会返回一个空的json内容。我们可以在<code>application.properties</code>配置文件中通过<code>info</code>前缀来设置一些属性，比如下面这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;wk-xcx&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;profile&quot;: &quot;dev&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="度量类指标"><a href="#度量类指标" class="headerlink" title="度量类指标"></a>度量类指标</h2><p>上面我们所介绍的应用配置类端点所提供的信息报告在应用启动的时候都已经基本确定了其返回内容，可以说是一个静态报告。而度量指标类端点提供的报告内容则是动态变化的，这些端点提供了应用程序在运行过程中的一些快照信息，比如：内存使用情况、HTTP请求统计、外部资源指标等。这些端点对于我们构建微服务架构中的监控系统非常有帮助，由于Spring Boot应用自身实现了这些端点，所以我们可以很方便地利用它们来收集我们想要的信息，以制定出各种自动化策略。下面，我们就来分别看看这些强大的端点功能。</p>
<h3 id="metrics"><a href="#metrics" class="headerlink" title="/metrics"></a>/metrics</h3><p>该端点用来返回当前应用的各类重要度量指标，比如：内存信息、线程信息、垃圾回收信息等。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;mem&quot;: 1653563,</span><br><span class="line">  &quot;mem.free&quot;: 445910,</span><br><span class="line">  &quot;processors&quot;: 8,</span><br><span class="line">  &quot;instance.uptime&quot;: 14159785,</span><br><span class="line">  &quot;uptime&quot;: 14163058,</span><br><span class="line">  &quot;systemload.average&quot;: 0.45,</span><br><span class="line">  &quot;heap.committed&quot;: 1564672,</span><br><span class="line">  &quot;heap.init&quot;: 1028096,</span><br><span class="line">  &quot;heap.used&quot;: 1118761,</span><br><span class="line">  &quot;heap&quot;: 14602240,</span><br><span class="line">  &quot;nonheap.committed&quot;: 91008,</span><br><span class="line">  &quot;nonheap.init&quot;: 2496,</span><br><span class="line">  &quot;nonheap.used&quot;: 88892,</span><br><span class="line">  &quot;nonheap&quot;: 0,</span><br><span class="line">  &quot;threads.peak&quot;: 83,</span><br><span class="line">  &quot;threads.daemon&quot;: 5,</span><br><span class="line">  &quot;threads.totalStarted&quot;: 905,</span><br><span class="line">  &quot;threads&quot;: 80,</span><br><span class="line">  &quot;classes&quot;: 9072,</span><br><span class="line">  &quot;classes.loaded&quot;: 9072,</span><br><span class="line">  &quot;classes.unloaded&quot;: 0,</span><br><span class="line">  &quot;gc.ps_scavenge.count&quot;: 9,</span><br><span class="line">  &quot;gc.ps_scavenge.time&quot;: 91,</span><br><span class="line">  &quot;gc.ps_marksweep.count&quot;: 2,</span><br><span class="line">  &quot;gc.ps_marksweep.time&quot;: 55,</span><br><span class="line">  &quot;gauge.response.beans&quot;: 28.0,</span><br><span class="line">  &quot;gauge.response.mappings&quot;: 6.0,</span><br><span class="line">  &quot;gauge.response.topic.lecturers.topicId&quot;: 33.0,</span><br><span class="line">  &quot;gauge.response.topic.page&quot;: 47.0,</span><br><span class="line">  &quot;gauge.response.autoconfig&quot;: 3.0,</span><br><span class="line">  &quot;gauge.response.course.comment.list.courseId&quot;: 18.0,</span><br><span class="line">  &quot;gauge.response.topic.comment.page&quot;: 32.0,</span><br><span class="line">  &quot;gauge.response.unmapped&quot;: 2.0,</span><br><span class="line">  &quot;gauge.response.info&quot;: 6.0,</span><br><span class="line">  &quot;gauge.response.share.miniProgram&quot;: 39.0,</span><br><span class="line">  &quot;gauge.response.topic.course.topicId&quot;: 27.0,</span><br><span class="line">  &quot;gauge.response.star-star.favicon.ico&quot;: 7.0,</span><br><span class="line">  &quot;gauge.response.topic.comment.my&quot;: 37.0,</span><br><span class="line">  &quot;gauge.response.env&quot;: 5.0,</span><br><span class="line">  &quot;gauge.response.health.root&quot;: 502.0,</span><br><span class="line">  &quot;gauge.response.course.content.list.courseId&quot;: 35.0,</span><br><span class="line">  &quot;gauge.response.topic.detail.topicId&quot;: 467.0,</span><br><span class="line">  &quot;gauge.response.banner.list&quot;: 26.0,</span><br><span class="line">  &quot;gauge.response.course.detail.courseId&quot;: 56.0,</span><br><span class="line">  &quot;gauge.response.topic.comment&quot;: 30.0,</span><br><span class="line">  &quot;gauge.response.configprops&quot;: 80.0,</span><br><span class="line">  &quot;gauge.response.order&quot;: 52.0,</span><br><span class="line">  &quot;counter.status.200.mappings&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.order&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.health.root&quot;: 979,</span><br><span class="line">  &quot;counter.status.200.share.miniProgram&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.configprops&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.course.detail.courseId&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.course.content.list.courseId&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.autoconfig&quot;: 2,</span><br><span class="line">  &quot;counter.status.200.topic.course.topicId&quot;: 28,</span><br><span class="line">  &quot;counter.status.200.banner.list&quot;: 30,</span><br><span class="line">  &quot;counter.status.200.topic.page&quot;: 60,</span><br><span class="line">  &quot;counter.status.200.env&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.course.comment.list.courseId&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.info&quot;: 2,</span><br><span class="line">  &quot;counter.status.200.star-star.favicon.ico&quot;: 2,</span><br><span class="line">  &quot;counter.status.200.beans&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.topic.comment&quot;: 2,</span><br><span class="line">  &quot;counter.status.200.topic.lecturers.topicId&quot;: 26,</span><br><span class="line">  &quot;counter.status.200.topic.comment.page&quot;: 35,</span><br><span class="line">  &quot;counter.status.403.unmapped&quot;: 4,</span><br><span class="line">  &quot;counter.status.200.topic.comment.my&quot;: 9,</span><br><span class="line">  &quot;counter.status.200.topic.detail.topicId&quot;: 28</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面的示例中，我们看到有这些重要的度量值：</p>
<ul>
<li>系统信息：包括处理器数量<code>processors</code>、运行时间<code>uptime</code>和<code>instance.uptime</code>、系统平均负载<code>systemload.average</code>。</li>
<li><code>mem.*</code>：内存概要信息，包括分配给应用的总内存数量以及当前空闲的内存数量。这些信息来自<code>java.lang.Runtime</code>。</li>
<li><code>heap.*</code>：堆内存使用情况。这些信息来自<code>java.lang.management.MemoryMXBean</code>接口中<code>getHeapMemoryUsage</code>方法获取的<code>java.lang.management.MemoryUsage</code>。</li>
<li><code>nonheap.*</code>：非堆内存使用情况。这些信息来自<code>java.lang.management.MemoryMXBean</code>接口中<code>getNonHeapMemoryUsage</code>方法获取的<code>java.lang.management.MemoryUsage</code>。</li>
<li><code>threads.*</code>：线程使用情况，包括线程数、守护线程数（daemon）、线程峰值（peak）等，这些数据均来自<code>java.lang.management.ThreadMXBean</code>。</li>
<li><code>classes.*</code>：应用加载和卸载的类统计。这些数据均来自<code>java.lang.management.ClassLoadingMXBean</code>。</li>
<li><code>gc.*</code>：垃圾收集器的详细信息，包括垃圾回收次数<code>gc.ps_scavenge.count</code>、垃圾回收消耗时间<code>gc.ps_scavenge.time</code>、标记-清除算法的次数<code>gc.ps_marksweep.count</code>、标记-清除算法的消耗时间<code>gc.ps_marksweep.time</code>。这些数据均来自<code>java.lang.management.GarbageCollectorMXBean</code>。</li>
<li><code>httpsessions.*</code>：Tomcat容器的会话使用情况。包括最大会话数<code>httpsessions.max</code>和活跃会话数<code>httpsessions.active</code>。该度量指标信息仅在引入了嵌入式Tomcat作为应用容器的时候才会提供。</li>
<li><code>gauge.*</code>：HTTP请求的性能指标之一，它主要用来反映一个绝对数值。比如上面示例中的<code>gauge.response.hello: 5</code>，它表示上一次<code>hello</code>请求的延迟时间为5毫秒。</li>
<li><code>counter.*</code>：HTTP请求的性能指标之一，它主要作为计数器来使用，记录了增加量和减少量。如上示例中<code>counter.status.200.hello: 11</code>，它代表了<code>hello</code>请求返回<code>200</code>状态的次数为11。</li>
</ul>
<p>对于<code>gauge.*</code>和<code>counter.*</code>的统计，这里有一个特殊的内容请求<code>star-star</code>，它代表了对静态资源的访问。这两类度量指标非常有用，我们不仅可以使用它默认的统计指标，还可以在程序中轻松的增加自定义统计值。只需要通过注入<code>org.springframework.boot.actuate.metrics.CounterService</code>和<code>org.springframework.boot.actuate.metrics.GaugeService</code>来实现自定义的统计指标信息。</p>
<ul>
<li><p><code>/metrics</code>端点可以提供应用运行状态的完整度量指标报告，这项功能非常的实用，但是对于监控系统中的各项监控功能，它们的监控内容、数据收集频率都有所不同，如果我们每次都通过全量获取报告的方式来收集，略显粗暴。所以，我们还可以通过<code>/metrics/{name}</code>接口来更细粒度的获取度量信息，比如我们可以通过访问<code>/metrics/mem.free</code>来获取当前可用内存数量。</p>
</li>
<li><p>/health：该端点在一开始的示例中我们已经使用过了，它用来获取应用的各类健康指标信息。在<code>spring-boot-starter-actuator</code>模块中自带实现了一些常用资源的健康指标检测器。这些检测器都通过<code>HealthIndicator</code>接口实现，并且会根据依赖关系的引入实现自动化装配，比如用于检测磁盘的<code>DiskSpaceHealthIndicator</code>、检测DataSource连接是否可用的<code>DataSourceHealthIndicator</code>等。有时候，我们可能还会用到一些Spring Boot的Starter POMs中还没有封装的产品来进行开发，比如：当使用RocketMQ作为消息代理时，由于没有自动化配置的检测器，所以我们需要自己来实现一个用来采集健康信息的检测器。比如，我们可以在Spring Boot的应用中，为<code>org.springframework.boot.actuate.health.HealthIndicator</code>接口实现一个对RocketMQ的检测器类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class RocketMQHealthIndicator implements HealthIndicator &#123;</span><br><span class="line">    @Override</span><br><span class="line">  public Health health() &#123;</span><br><span class="line">        int errorCode = check();</span><br><span class="line">        if (errorCode != 0) &#123;</span><br><span class="line">            return Health.down().withDetail(&quot;Error Code&quot;, errorCode).build();</span><br><span class="line">        &#125;</span><br><span class="line">        return Health.up().build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private int check() &#123;</span><br><span class="line">        // 对监控对象的检测操作</span><br><span class="line">  return 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通过重写<code>health()</code>函数来实现健康检查，返回的<code>Heath</code>对象中，共有两项内容，一个是状态信息，除了该示例中的<code>UP</code>与<code>DOWN</code>之外，还有<code>UNKNOWN</code>和<code>OUT_OF_SERVICE</code>，可以根据需要来实现返回；还有一个详细信息，采用Map的方式存储，在这里通过<code>withDetail</code>函数，注入了一个Error Code信息，我们也可以填入一下其他信息，比如，检测对象的IP地址、端口等。重新启动应用，并访问<code>/health</code>接口，我们在返回的JSON字符串中，将会包含了如下信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;rocketMQ&quot;: &#123;</span><br><span class="line"> &quot;status&quot;: &quot;UP&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="dump"><a href="#dump" class="headerlink" title="/dump"></a>/dump</h3><p>该端点用来暴露程序运行中的线程信息。它使用<code>java.lang.management.ThreadMXBean</code>的<code>dumpAllThreads</code>方法来返回所有含有同步信息的活动线程详情。</p>
<h3 id="trace"><a href="#trace" class="headerlink" title="/trace"></a>/trace</h3><p>该端点用来返回基本的HTTP跟踪信息。默认情况下，跟踪信息的存储采用<code>org.springframework.boot.actuate.trace.InMemoryTraceRepository</code>实现的内存方式，始终保留最近的100条请求记录。它记录的内容格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">	&quot;timestamp&quot;: 1528117084553,</span><br><span class="line">	&quot;info&quot;: &#123;</span><br><span class="line">		&quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">		&quot;path&quot;: &quot;/health/&quot;,</span><br><span class="line">		&quot;headers&quot;: &#123;</span><br><span class="line">			&quot;request&quot;: &#123;</span><br><span class="line">				&quot;Accept&quot;: &quot;application/json&quot;,</span><br><span class="line">				&quot;Connection&quot;: &quot;Keep-Alive&quot;,</span><br><span class="line">				&quot;User-Agent&quot;: &quot;Apache-HttpClient/4.5.5 (Java/1.8.0_162)&quot;,</span><br><span class="line">				&quot;Host&quot;: &quot;172.30.15.3:17140&quot;,</span><br><span class="line">				&quot;Accept-Encoding&quot;: &quot;gzip,deflate&quot;</span><br><span class="line">			&#125;,</span><br><span class="line">			&quot;response&quot;: &#123;</span><br><span class="line">				&quot;Transfer-Encoding&quot;: &quot;chunked&quot;,</span><br><span class="line">				&quot;Connection&quot;: &quot;keep-alive&quot;,</span><br><span class="line">				&quot;X-Application-Context&quot;: &quot;wk-xcx:dev:17140&quot;,</span><br><span class="line">				&quot;Date&quot;: &quot;Mon, 04 Jun 2018 12:58:04 GMT&quot;,</span><br><span class="line">				&quot;Content-Type&quot;: &quot;application/json;charset=UTF-8&quot;,</span><br><span class="line">				&quot;status&quot;: &quot;200&quot;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;timeTaken&quot;: &quot;443&quot;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line"> ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h2 id="操作控制类"><a href="#操作控制类" class="headerlink" title="操作控制类"></a>操作控制类</h2><h3 id="shutdown"><a href="#shutdown" class="headerlink" title="/shutdown"></a>/shutdown</h3><p>仔细的读者可能会发现，我们在“初识Actuator”时运行示例的控制台中输出的所有监控端点，已经在介绍应用配置类端点和度量指标类端点时都讲解完了。那么还有哪些是操作控制类端点呢？实际上，由于之前介绍的所有端点都是用来反映应用自身的属性或是运行中的状态，相对于操作控制类端点没有那么敏感，所以他们默认都是启用的。而操作控制类端点拥有更强大的控制能力，如果要使用它们的话，需要通过属性来配置开启。</p>
<p>在原生端点中，只提供了一个用来关闭应用的端点：<code>/shutdown</code>。我们可以通过如下配置开启它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">endpoints.shutdown.enabled=true</span><br></pre></td></tr></table></figure>
<p>在配置了上述属性之后，只需要访问该应用的<code>/shutdown</code>端点就能实现关闭该应用的远程操作。由于开放关闭应用的操作本身是一件非常危险的事，所以真正在线上使用的时候，我们需要对其加入一定的保护机制，比如：定制Actuator的端点路径、整合Spring Security进行安全校验等。</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="https://github.com/wyb1992">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#初识Actuator"><span class="toc-number">1.</span> <span class="toc-text">初识Actuator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原生端点"><span class="toc-number">2.</span> <span class="toc-text">原生端点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用配置类"><span class="toc-number">3.</span> <span class="toc-text">应用配置类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#autoconfig"><span class="toc-number">3.1.</span> <span class="toc-text">/autoconfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beans"><span class="toc-number">3.2.</span> <span class="toc-text">/beans</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configprops"><span class="toc-number">3.3.</span> <span class="toc-text">/configprops</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#env"><span class="toc-number">3.4.</span> <span class="toc-text">/env</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mappings"><span class="toc-number">3.5.</span> <span class="toc-text">/mappings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#info"><span class="toc-number">3.6.</span> <span class="toc-text">/info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#度量类指标"><span class="toc-number">4.</span> <span class="toc-text">度量类指标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-number">4.1.</span> <span class="toc-text">/metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump"><span class="toc-number">4.2.</span> <span class="toc-text">/dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace"><span class="toc-number">4.3.</span> <span class="toc-text">/trace</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作控制类"><span class="toc-number">5.</span> <span class="toc-text">操作控制类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shutdown"><span class="toc-number">5.1.</span> <span class="toc-text">/shutdown</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&text=使用Spring Boot Actuator监控应用"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&is_video=false&description=使用Spring Boot Actuator监控应用"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=使用Spring Boot Actuator监控应用&body=Check out this article: https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&title=使用Spring Boot Actuator监控应用"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wyb1992.github.io/2018/06/04/使用Spring-Boot-Actuator监控应用/&name=使用Spring Boot Actuator监控应用&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 wyb
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="https://github.com/wyb1992">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-120230928-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


