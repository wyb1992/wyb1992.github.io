<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="什么是JWTJson web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于">
<meta name="keywords" content="Java,JWT,后端技术">
<meta property="og:type" content="article">
<meta property="og:title" content="使用JWT保护你的Spring Boot应用 - Spring Security实战">
<meta property="og:url" content="https://wyb1992.github.io/2018/05/22/初探JWT/index.html">
<meta property="og:site_name" content="wyb&#39;s note">
<meta property="og:description" content="什么是JWTJson web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://wyb1992.github.io/images/JWT-1.jpg">
<meta property="og:image" content="https://wyb1992.github.io/images/JWT-2.jpg">
<meta property="og:updated_time" content="2018-05-24T00:17:20.795Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用JWT保护你的Spring Boot应用 - Spring Security实战">
<meta name="twitter:description" content="什么是JWTJson web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于">
<meta name="twitter:image" content="https://wyb1992.github.io/images/JWT-1.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>使用JWT保护你的Spring Boot应用 - Spring Security实战</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2018/05/07/Docker学习笔记/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wyb1992.github.io/2018/05/22/初探JWT/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wyb1992.github.io/2018/05/22/初探JWT/&text=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wyb1992.github.io/2018/05/22/初探JWT/&is_video=false&description=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=使用JWT保护你的Spring Boot应用 - Spring Security实战&body=Check out this article: https://wyb1992.github.io/2018/05/22/初探JWT/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wyb1992.github.io/2018/05/22/初探JWT/&name=使用JWT保护你的Spring Boot应用 - Spring Security实战&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#什么是JWT"><span class="toc-number">1.</span> <span class="toc-text">什么是JWT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基于Session的登录认证"><span class="toc-number">2.</span> <span class="toc-text">基于Session的登录认证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT"><span class="toc-number">3.</span> <span class="toc-text">JWT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#header"><span class="toc-number">3.0.1.</span> <span class="toc-text">header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建Spring-Boot应用"><span class="toc-number">4.</span> <span class="toc-text">创建Spring Boot应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建一个Web应用"><span class="toc-number">5.</span> <span class="toc-text">创建一个Web应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用JWT保护你的Spring-Boot应用"><span class="toc-number">6.</span> <span class="toc-text">使用JWT保护你的Spring Boot应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#添加Spring-Security"><span class="toc-number">7.</span> <span class="toc-text">添加Spring Security</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#本文代码"><span class="toc-number">8.</span> <span class="toc-text">本文代码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资源"><span class="toc-number">9.</span> <span class="toc-text">参考资源</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        使用JWT保护你的Spring Boot应用 - Spring Security实战
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">wyb's note</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-05-22T09:18:23.000Z" itemprop="datePublished">2018-05-22</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/JWT/">JWT</a>, <a class="tag-link" href="/tags/Java/">Java</a>, <a class="tag-link" href="/tags/后端技术/">后端技术</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="什么是JWT"><a href="#什么是JWT" class="headerlink" title="什么是JWT"></a>什么是JWT</h1><p>Json web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>
<h1 id="基于Session的登录认证"><a href="#基于Session的登录认证" class="headerlink" title="基于Session的登录认证"></a>基于Session的登录认证</h1><p>在传统的用户登录认证中，因为http是无状态的，所以都是采用session方式。用户登录成功，服务端会保证一个session，当然会给客户端一个sessionId，客户端会把sessionId保存在cookie中，每次请求都会携带这个sessionId。<br>cookie+session这种模式通常是保存在内存中，而且服务从单服务到多服务会面临的session共享问题，随着用户量的增多，开销就会越大。而JWT不是这样的，只需要服务端生成token，客户端保存这个token，每次请求携带这个token，服务端认证解析就可。</p>
<h1 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h1><p>第一部分我们称它为头部<code>header</code>，第二部分我们称其为载荷<code>payload</code>，第三部分是签证<code>signature</code>。</p>
<h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><ul>
<li>声明类型，这里是JWT</li>
<li>声明加密的算法，本文中使用HmacSHA512</li>
</ul>
<h1 id="创建Spring-Boot应用"><a href="#创建Spring-Boot应用" class="headerlink" title="创建Spring Boot应用"></a>创建Spring Boot应用</h1><p>本文用<code>IntellJ IDEA</code>快速创建了一个Spring Boot应用，过程这里不再赘述。我们看下整个项目的<code>pom.xml</code>文件中的依赖部分：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure></p>
<p>所有Spring Boot相关的依赖都是以starter形式出现，这样你无需关心版本和相关的依赖，所以这样大大简化了开发过程。</p>
<h1 id="创建一个Web应用"><a href="#创建一个Web应用" class="headerlink" title="创建一个Web应用"></a>创建一个Web应用</h1><p>我们先创建一个可以返回JSON的Controller。修改程序的入口文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication</span><br><span class="line">@RestController</span><br><span class="line">@EnableAutoConfiguration</span><br><span class="line">public class JwtApplication &#123;</span><br><span class="line"></span><br><span class="line">    // main函数，Spring Boot程序入口</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(JwtApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 根目录映射 Get访问方式 直接返回一个字符串</span><br><span class="line">    @RequestMapping(&quot;/&quot;)</span><br><span class="line">    Map&lt;String, String&gt; hello() &#123;</span><br><span class="line">      // 返回map会变成JSON key value方式</span><br><span class="line">      Map&lt;String,String&gt; map=new HashMap&lt;String,String&gt;();</span><br><span class="line">      map.put(&quot;content&quot;, &quot;Hello JWT&quot;);</span><br><span class="line">      return map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个入口类我们添加<code>@RestController</code>和<code>@EnableAutoConfiguration</code>两个注解。<code>@RestController</code>注解相当于<code>@ResponseBody</code>和<code>@Controller</code>合在一起的作用。</p>
<p>run整个项目。访问<a href="http://localhost:8080/就能看到这个JSON的输出" target="_blank" rel="noopener">http://localhost:8080/就能看到这个JSON的输出</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;content&quot;: &quot;Hello JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>为了显示统一的JSON返回，这里建立一个JSONResult类进行。修改pom.xml，加入<code>fastjson</code>相关依赖。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.45&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后在我们的代码中加入一个新的类，里面只有一个结果集处理方法，因为只是个Demo，所有这里都放在一个文件中。这个类只是让返回的JSON结果变为三部分：</p>
<ul>
<li>status - 返回状态码 0 代表正常返回，其他都是错误</li>
<li>message - 一般显示错误信息</li>
<li>result - 结果集<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class JSONResult&#123;</span><br><span class="line">    public static String fillResultString(Integer status, String message, Object result)&#123;</span><br><span class="line">        JSONObject jsonObject = new JSONObject()&#123;&#123;</span><br><span class="line">            put(&quot;status&quot;, status);</span><br><span class="line">            put(&quot;message&quot;, message);</span><br><span class="line">            put(&quot;result&quot;, result);</span><br><span class="line">        &#125;&#125;;</span><br><span class="line">        return jsonObject.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>然后我们引入一个新的@RestController并返回一些简单的结果，后面我们将对这些内容进行访问控制，这里用到了上面的结果集处理类。这里多放两个方法，后面我们来测试权限和角色的验证用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">class UserController &#123;</span><br><span class="line"></span><br><span class="line">	// 路由映射到/users</span><br><span class="line">	@RequestMapping(value = &quot;/users&quot;, produces=&quot;application/json;charset=UTF-8&quot;)</span><br><span class="line">	public String usersList() &#123;</span><br><span class="line"></span><br><span class="line">		ArrayList&lt;String&gt; users =  new ArrayList&lt;String&gt;()&#123;&#123;</span><br><span class="line">			add(&quot;wyb&quot;);</span><br><span class="line">			add(&quot;tom&quot;);</span><br><span class="line">			add(&quot;jerry&quot;);</span><br><span class="line">		&#125;&#125;;</span><br><span class="line"></span><br><span class="line">		return JSONResult.fillResultString(0, &quot;&quot;, users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@RequestMapping(value = &quot;/hello&quot;, produces=&quot;application/json;charset=UTF-8&quot;)</span><br><span class="line">	public String hello() &#123;</span><br><span class="line">		ArrayList&lt;String&gt; users =  new ArrayList&lt;String&gt;()&#123;&#123; add(&quot;hello&quot;); &#125;&#125;;</span><br><span class="line">		return JSONResult.fillResultString(0, &quot;&quot;, users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@RequestMapping(value = &quot;/world&quot;, produces=&quot;application/json;charset=UTF-8&quot;)</span><br><span class="line">	public String world() &#123;</span><br><span class="line">		ArrayList&lt;String&gt; users =  new ArrayList&lt;String&gt;()&#123;&#123; add(&quot;world&quot;); &#125;&#125;;</span><br><span class="line">		return JSONResult.fillResultString(0, &quot;&quot;, users);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>重新run这个文件，访问<a href="http://localhost:8080/users就看到了下面的结果" target="_blank" rel="noopener">http://localhost:8080/users就看到了下面的结果</a>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &quot;wyb&quot;,</span><br><span class="line">    &quot;tom&quot;,</span><br><span class="line">    &quot;jerry&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;message&quot;: &quot;&quot;,</span><br><span class="line">  &quot;status&quot;: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="使用JWT保护你的Spring-Boot应用"><a href="#使用JWT保护你的Spring-Boot应用" class="headerlink" title="使用JWT保护你的Spring Boot应用"></a>使用JWT保护你的Spring Boot应用</h1><p>开始介绍正题，这里我们会对<strong>/users</strong>进行访问控制，先通过申请一个<code>JWT(JSON Web Token读jot)</code>，然后通过这个访问<strong>/users</strong>，才能拿到数据。<br>JWT很大程度上还是个新技术，通过使用HMAC(Hash-based Message Authentication Code)计算信息摘要，也可以用RSA公私钥中的私钥进行签名。这个根据业务场景进行选择，想了解更多<a href="https://jwt.io/" target="_blank" rel="noopener">JWT</a>，可点链接进一步学习。</p>
<h1 id="添加Spring-Security"><a href="#添加Spring-Security" class="headerlink" title="添加Spring Security"></a>添加Spring Security</h1><p>在pom.xml添加security，让用户在/login进行登录并获取<strong>Token</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jjwt&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.7.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>至此我们之前所有的路由都需要身份验证。我们将引入一个安全设置类<strong>WebSecurityConfig</strong>，这个类需要从<strong>WebSecurityConfigurerAdapter</strong>类继承。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableWebSecurity</span><br><span class="line">class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    // 设置 HTTP 验证规则</span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">        // 关闭csrf验证</span><br><span class="line">        http.csrf().disable()</span><br><span class="line">                // 对请求进行认证</span><br><span class="line">                .authorizeRequests()</span><br><span class="line">                // 所有 / 的所有请求 都放行</span><br><span class="line">                .antMatchers(&quot;/&quot;).permitAll()</span><br><span class="line">                // 所有 /login 的POST请求 都放行</span><br><span class="line">                .antMatchers(HttpMethod.POST, &quot;/login&quot;).permitAll()</span><br><span class="line">                // 权限检查</span><br><span class="line">                .antMatchers(&quot;/hello&quot;).hasAuthority(&quot;AUTH_WRITE&quot;)</span><br><span class="line">                // 角色检查</span><br><span class="line">                .antMatchers(&quot;/world&quot;).hasRole(&quot;ADMIN&quot;)</span><br><span class="line">                // 所有请求需要身份认证</span><br><span class="line">                .anyRequest().authenticated()</span><br><span class="line">            .and()</span><br><span class="line">                // 添加一个过滤器 所有访问 /login 的请求交给 JWTLoginFilter 来处理 这个类处理所有的JWT相关内容</span><br><span class="line">                .addFilterBefore(new JWTLoginFilter(&quot;/login&quot;, authenticationManager()),</span><br><span class="line">                        UsernamePasswordAuthenticationFilter.class)</span><br><span class="line">                // 添加一个过滤器验证其他请求的Token是否合法</span><br><span class="line">                .addFilterBefore(new JWTAuthenticationFilter(),</span><br><span class="line">                        UsernamePasswordAuthenticationFilter.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123;</span><br><span class="line">        // 使用自定义身份验证组件</span><br><span class="line">        auth.authenticationProvider(new CustomAuthenticationProvider());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>先放两个基本类，一个负责存储用户名密码，另一个是一个权限类型，负责存储权限和角色。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">class AccountCredentials &#123;</span><br><span class="line"></span><br><span class="line">    private String username;</span><br><span class="line">    private String password;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getPassword() &#123;</span><br><span class="line">        return password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPassword(String password) &#123;</span><br><span class="line">        this.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class GrantedAuthorityImpl implements GrantedAuthority&#123;</span><br><span class="line">    private String authority;</span><br><span class="line"></span><br><span class="line">    public GrantedAuthorityImpl(String authority) &#123;</span><br><span class="line">        this.authority = authority;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAuthority(String authority) &#123;</span><br><span class="line">        this.authority = authority;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getAuthority() &#123;</span><br><span class="line">        return this.authority;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在上面的安全设置类中，我们设置所有人都能访问/和POST方式访问/login，其他的任何路由都需要进行认证。然后将所有访问/login的请求，都交给<strong>JWTLoginFilter</strong>过滤器来处理。稍后我们会创建这个过滤器和其他这里需要的<strong>JWTAuthenticationFilter</strong>和<strong>CustomAuthenticationProvider</strong>两个类。</p>
<p>先建立一个JWT生成和验签的类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">class TokenAuthenticationService &#123;</span><br><span class="line">    static final long EXPIRATIONTIME = 432_000_000;     // 5天</span><br><span class="line">    static final String SECRET = &quot;P@ssw02d&quot;;            // JWT密码</span><br><span class="line">    static final String TOKEN_PREFIX = &quot;Token&quot;;        // Token前缀</span><br><span class="line">    static final String HEADER_STRING = &quot;Authorization&quot;;// 存放Token的Header Key</span><br><span class="line"></span><br><span class="line">  // JWT生成方法</span><br><span class="line">    static void addAuthentication(HttpServletResponse response, String username) &#123;</span><br><span class="line"></span><br><span class="line">    // 生成JWT</span><br><span class="line">        String JWT = Jwts.builder()</span><br><span class="line">                // 保存权限（角色）</span><br><span class="line">                .claim(&quot;authorities&quot;, &quot;ROLE_ADMIN,AUTH_WRITE&quot;)</span><br><span class="line">                // 用户名写入标题</span><br><span class="line">                .setSubject(username)</span><br><span class="line">                // 有效期设置</span><br><span class="line">                        .setExpiration(new Date(System.currentTimeMillis() + EXPIRATIONTIME))</span><br><span class="line">                // 签名设置</span><br><span class="line">                        .signWith(SignatureAlgorithm.HS512, SECRET)</span><br><span class="line">                        .compact();</span><br><span class="line"></span><br><span class="line">        // 将 JWT 写入 body</span><br><span class="line">        try &#123;</span><br><span class="line">            response.setContentType(&quot;application/json&quot;);</span><br><span class="line">            response.setStatus(HttpServletResponse.SC_OK);</span><br><span class="line">            response.getOutputStream().println(JSONResult.fillResultString(0, &quot;&quot;, JWT));</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  // JWT验证方法</span><br><span class="line">    static Authentication getAuthentication(HttpServletRequest request) &#123;</span><br><span class="line">        // 从Header中拿到token</span><br><span class="line">        String token = request.getHeader(HEADER_STRING);</span><br><span class="line"></span><br><span class="line">        if (token != null) &#123;</span><br><span class="line">            // 解析 Token</span><br><span class="line">            Claims claims = Jwts.parser()</span><br><span class="line">                    // 验签</span><br><span class="line">                    .setSigningKey(SECRET)</span><br><span class="line">                    // 去掉 Bearer</span><br><span class="line">                    .parseClaimsJws(token.replace(TOKEN_PREFIX, &quot;&quot;))</span><br><span class="line">                    .getBody();</span><br><span class="line"></span><br><span class="line">            // 拿用户名</span><br><span class="line">            String user = claims.getSubject();</span><br><span class="line"></span><br><span class="line">            // 得到 权限（角色）</span><br><span class="line">            List&lt;GrantedAuthority&gt; authorities =  AuthorityUtils.commaSeparatedStringToAuthorityList((String) claims.get(&quot;authorities&quot;));</span><br><span class="line"></span><br><span class="line">            // 返回验证令牌</span><br><span class="line">            return user != null ?</span><br><span class="line">                    new UsernamePasswordAuthenticationToken(user, null, authorities) :</span><br><span class="line">                    null;</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个类就两个static方法，一个负责生成JWT，一个负责认证JWT最后生成验证令牌。</p>
<p>下面来看自定义验证组件，这里简单写了，这个类就是提供密码验证功能，在实际使用时换成自己相应的验证逻辑，从数据库中取出、比对、赋予用户相应权限。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// 自定义身份认证验证组件</span><br><span class="line">class CustomAuthenticationProvider implements AuthenticationProvider &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123;</span><br><span class="line">        // 获取认证的用户名 &amp; 密码</span><br><span class="line">        String name = authentication.getName();</span><br><span class="line">        String password = authentication.getCredentials().toString();</span><br><span class="line"></span><br><span class="line">        // 认证逻辑</span><br><span class="line">        if (name.equals(&quot;admin&quot;) &amp;&amp; password.equals(&quot;123456&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            // 这里设置权限和角色</span><br><span class="line">            ArrayList&lt;GrantedAuthority&gt; authorities = new ArrayList&lt;&gt;();</span><br><span class="line">            authorities.add( new GrantedAuthorityImpl(&quot;ROLE_ADMIN&quot;) );</span><br><span class="line">            authorities.add( new GrantedAuthorityImpl(&quot;AUTH_WRITE&quot;) );</span><br><span class="line">            // 生成令牌</span><br><span class="line">            Authentication auth = new UsernamePasswordAuthenticationToken(name, password, authorities);</span><br><span class="line">            return auth;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            throw new BadCredentialsException(&quot;密码错误~&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 是否可以提供输入类型的认证服务</span><br><span class="line">    @Override</span><br><span class="line">    public boolean supports(Class&lt;?&gt; authentication) &#123;</span><br><span class="line">        return authentication.equals(UsernamePasswordAuthenticationToken.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>下面实现<strong>JWTLoginFilter</strong> 这个Filter比较简单，除了构造函数需要重写三个方法。</p>
<ul>
<li>attemptAuthentication - 登录时需要验证时候调用</li>
<li>successfulAuthentication - 验证成功后调用</li>
<li>unsuccessfulAuthentication - 验证失败后调用，这里直接灌入500错误返回，由于同一JSON返回，HTTP就都返回200了<figure class="highlight plain"><figcaption><span>JWTLoginFilter extends AbstractAuthenticationProcessingFilter &#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    public JWTLoginFilter(String url, AuthenticationManager authManager) &#123;</span><br><span class="line">        super(new AntPathRequestMatcher(url));</span><br><span class="line">        setAuthenticationManager(authManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Authentication attemptAuthentication(</span><br><span class="line">            HttpServletRequest req, HttpServletResponse res)</span><br><span class="line">            throws AuthenticationException, IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        // JSON反序列化成 AccountCredentials</span><br><span class="line">        AccountCredentials creds = new ObjectMapper().readValue(req.getInputStream(), AccountCredentials.class);</span><br><span class="line"></span><br><span class="line">        // 返回一个验证令牌</span><br><span class="line">        return getAuthenticationManager().authenticate(</span><br><span class="line">                new UsernamePasswordAuthenticationToken(</span><br><span class="line">                        creds.getUsername(),</span><br><span class="line">                        creds.getPassword()</span><br><span class="line">                )</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void successfulAuthentication(</span><br><span class="line">            HttpServletRequest req,</span><br><span class="line">            HttpServletResponse res, FilterChain chain,</span><br><span class="line">            Authentication auth) throws IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        TokenAuthenticationService.addAuthentication(res, auth.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed) throws IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        response.setContentType(&quot;application/json&quot;);</span><br><span class="line">        response.setStatus(HttpServletResponse.SC_OK);</span><br><span class="line">        response.getOutputStream().println(JSONResult.fillResultString(500, &quot;Internal Server Error!!!&quot;, &quot;&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>再完成最后一个类<strong>JWTAuthenticationFilter</strong>，这也是个拦截器，它拦截所有需要JWT的请求，然后调用<strong>TokenAuthenticationService</strong>类的静态方法去做JWT验证。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class JWTAuthenticationFilter extends GenericFilterBean &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void doFilter(ServletRequest request,</span><br><span class="line">                         ServletResponse response,</span><br><span class="line">                         FilterChain filterChain)</span><br><span class="line">            throws IOException, ServletException &#123;</span><br><span class="line">        Authentication authentication = TokenAuthenticationService</span><br><span class="line">                .getAuthentication((HttpServletRequest)request);</span><br><span class="line"></span><br><span class="line">        SecurityContextHolder.getContext()</span><br><span class="line">                .setAuthentication(authentication);</span><br><span class="line">        filterChain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码就写完了，整个<strong>Spring Security</strong>结合<strong>JWT</strong>基本就差不多了，下面我们来测试下，并说下整体流程。<br>开始测试，先运行整个项目，这里介绍下过程：</p>
<ul>
<li>先程序启动 - main函数</li>
<li>注册验证组件 - <code>WebSecurityConfig</code> 类 <code>configure(AuthenticationManagerBuilder auth)</code>方法，这里我们注册了自定义验证组件</li>
<li>设置验证规则 - <code>WebSecurityConfig</code> 类 <code>configure(HttpSecurity http)</code>方法，这里设置了各种路由访问规则</li>
<li>初始化过滤组件 - <code>JWTLoginFilter</code> 和 <code>JWTAuthenticationFilter</code> 类会初始化<br>首先测试获取Token，这里使用Postman来测试。</li>
</ul>
<p><img src="/images/JWT-1.jpg" alt="获取Token"></p>
<p>这里我们得到了相关的JWT，反Base64之后,就是下面的内容，标准JWT。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS512&quot;&#125;&#123;&quot;authorities&quot;:&quot;ROLE_ADMIN,AUTH_WRITE&quot;,&quot;sub&quot;:&quot;admin&quot;,&quot;exp&quot;:1527506613&#125;kÞÛsBèÅ)&#125;§[Ê­;EISªi¤3×ÞîbÄçåMÙ¬Á\lç±ÎWÍt«ÃâA~üÀ</span><br></pre></td></tr></table></figure></p>
<p>整个过程如下：</p>
<ul>
<li>拿到传入JSON，解析用户名密码 - <strong>JWTLoginFilter</strong> 类 <strong>attemptAuthentication</strong> 方法</li>
<li>自定义身份认证验证组件，进行身份认证 - <strong>CustomAuthenticationProvider</strong> 类 <strong>authenticate</strong> 方法</li>
<li>验证成功 - <strong>JWTLoginFilter</strong> 类 <strong>successfulAuthentication</strong> 方法</li>
<li>生成JWT - <strong>TokenAuthenticationService</strong> 类 <strong>addAuthentication</strong> 方法</li>
</ul>
<p>再测试一个访问资源的：</p>
<p><img src="/images/JWT-2.jpg" alt="访问资源"></p>
<p>说明我们的Token生效可以正常访问。其他的结果您可以自己去测试。再回到处理流程：</p>
<ul>
<li>接到请求进行拦截 - <strong>JWTAuthenticationFilter</strong> 中的方法</li>
<li>验证JWT - <strong>TokenAuthenticationService</strong> 类 <strong>getAuthentication</strong> 方法</li>
<li>访问Controller</li>
</ul>
<p>本文主要介绍了如何用Spring Security结合JWT保护你的Spring Boot应用。主要流程就结束了，希望能对你有帮助，代码会放到Github上。</p>
<h1 id="本文代码"><a href="#本文代码" class="headerlink" title="本文代码"></a>本文代码</h1><p><a href="https://github.com/wyb1992/spring-boot-with-jwts" target="_blank" rel="noopener">GitHub代码</a></p>
<h1 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h1><ol>
<li><a href="https://auth0.com/blog/securing-spring-boot-with-jwts/" target="_blank" rel="noopener">securing-spring-boot-with-jwts</a></li>
<li><a href="http://www.jwt.io/" target="_blank" rel="noopener">jwt</a></li>
</ol>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#什么是JWT"><span class="toc-number">1.</span> <span class="toc-text">什么是JWT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基于Session的登录认证"><span class="toc-number">2.</span> <span class="toc-text">基于Session的登录认证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT"><span class="toc-number">3.</span> <span class="toc-text">JWT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#header"><span class="toc-number">3.0.1.</span> <span class="toc-text">header</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建Spring-Boot应用"><span class="toc-number">4.</span> <span class="toc-text">创建Spring Boot应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建一个Web应用"><span class="toc-number">5.</span> <span class="toc-text">创建一个Web应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用JWT保护你的Spring-Boot应用"><span class="toc-number">6.</span> <span class="toc-text">使用JWT保护你的Spring Boot应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#添加Spring-Security"><span class="toc-number">7.</span> <span class="toc-text">添加Spring Security</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#本文代码"><span class="toc-number">8.</span> <span class="toc-text">本文代码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资源"><span class="toc-number">9.</span> <span class="toc-text">参考资源</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wyb1992.github.io/2018/05/22/初探JWT/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wyb1992.github.io/2018/05/22/初探JWT/&text=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wyb1992.github.io/2018/05/22/初探JWT/&is_video=false&description=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=使用JWT保护你的Spring Boot应用 - Spring Security实战&body=Check out this article: https://wyb1992.github.io/2018/05/22/初探JWT/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wyb1992.github.io/2018/05/22/初探JWT/&title=使用JWT保护你的Spring Boot应用 - Spring Security实战"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wyb1992.github.io/2018/05/22/初探JWT/&name=使用JWT保护你的Spring Boot应用 - Spring Security实战&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 wyb
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


